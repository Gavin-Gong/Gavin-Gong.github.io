<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RxJS | Gavin Gong</title>
    <meta name="description" content="Code &amp; Life">
    
    
    <link rel="preload" href="/assets/css/27.styles.f3a61078.css" as="style"><link rel="preload" href="/assets/js/app.aaf8f33b.js" as="script"><link rel="preload" href="/assets/js/10.38700973.js" as="script"><link rel="prefetch" href="/assets/js/14.fc52ed78.js"><link rel="prefetch" href="/assets/js/1.67ae3191.js"><link rel="prefetch" href="/assets/js/2.c0be736e.js"><link rel="prefetch" href="/assets/js/3.536b505c.js"><link rel="prefetch" href="/assets/js/4.227d0c5a.js"><link rel="prefetch" href="/assets/js/5.dcd40105.js"><link rel="prefetch" href="/assets/js/6.145fbe8e.js"><link rel="prefetch" href="/assets/js/7.c72f5b9b.js"><link rel="prefetch" href="/assets/js/8.9fda387a.js"><link rel="prefetch" href="/assets/js/9.d055cee9.js"><link rel="prefetch" href="/assets/js/11.481eba03.js"><link rel="prefetch" href="/assets/js/12.a9232749.js"><link rel="prefetch" href="/assets/js/13.67085df5.js"><link rel="prefetch" href="/assets/js/0.82aeb265.js"><link rel="prefetch" href="/assets/js/15.8393c1db.js"><link rel="prefetch" href="/assets/js/16.247003db.js"><link rel="prefetch" href="/assets/js/17.6c5e781c.js"><link rel="prefetch" href="/assets/js/18.e2cabf5d.js"><link rel="prefetch" href="/assets/js/19.6d33b8aa.js"><link rel="prefetch" href="/assets/js/20.6984d302.js"><link rel="prefetch" href="/assets/js/21.a0c82a84.js"><link rel="prefetch" href="/assets/js/22.859dc4f4.js"><link rel="prefetch" href="/assets/js/23.574f8a55.js"><link rel="prefetch" href="/assets/js/24.ea5e0d95.js"><link rel="prefetch" href="/assets/js/25.8f4a37a4.js"><link rel="prefetch" href="/assets/js/26.0fe5ff57.js">
    <link rel="stylesheet" href="/assets/css/27.styles.f3a61078.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Gavin Gong
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link router-link-active">主页</a></div><div class="nav-item"><a href="/Go/" class="nav-link">Go</a></div><div class="nav-item"><a href="https://github.com/Gavin-Gong" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link router-link-active">主页</a></div><div class="nav-item"><a href="/Go/" class="nav-link">Go</a></div><div class="nav-item"><a href="https://github.com/Gavin-Gong" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav><!----></div><div class="page"><div class="content"><h2 id="rxjs"><a href="#rxjs" aria-hidden="true" class="header-anchor">#</a> RxJS</h2><blockquote><p>RxJS 6</p></blockquote><h3 id="操作符"><a href="#操作符" aria-hidden="true" class="header-anchor">#</a> 操作符</h3><p>一些常用的操作符</p><ul><li>of</li><li>from</li><li>first</li><li>last</li><li>tap</li><li>interval</li><li>timer</li><li>forkJoin</li><li>filter</li><li>map</li><li>switchMap</li><li>scan</li><li>takeWhile</li><li>takeUtil</li><li>take</li><li>concat</li><li>throttle</li><li>debounce</li><li>merge</li></ul><h4 id="of"><a href="#of" aria-hidden="true" class="header-anchor">#</a> of</h4><p>将数字转化为  <code>Observable</code></p><div class="language-javascript extra-class"><pre class="language-javascript"><code>Rx<span class="token punctuation">.</span><span class="token keyword">of</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出 1, 2</span>
</code></pre></div><h4 id="concat"><a href="#concat" aria-hidden="true" class="header-anchor">#</a> concat</h4><p>前面的流执行完成在执行后面的流</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>Rx<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">concat</span><span class="token punctuation">(</span>Rx<span class="token punctuation">.</span><span class="token function">timer</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Rx<span class="token punctuation">.</span><span class="token keyword">of</span><span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'concat: emit'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>输出</p><div class="language- extra-class"><pre class="language-text"><code>concat: emit x
concat: emit y
concat: emit z
concat: emit 0
concat: emit 3
concat: emit 2
</code></pre></div><h4 id="forkjoin"><a href="#forkjoin" aria-hidden="true" class="header-anchor">#</a> forkJoin</h4><p>类似<code>Promise.all</code>, 同时执行多个流, 在所有流执行完成之后传递一个数据数组.</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>Rx<span class="token punctuation">.</span><span class="token function">forkJoin</span><span class="token punctuation">(</span><span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>r <span class="token operator">=&gt;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise: emit'</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="mergemap-flatmap"><a href="#mergemap-flatmap" aria-hidden="true" class="header-anchor">#</a> mergeMap(flatMap)</h4><p>流相乘</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>Rx<span class="token punctuation">.</span><span class="token keyword">of</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
    <span class="token function">mergeMap</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Rx<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
        <span class="token function">map</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> i <span class="token operator">+</span> x<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>r <span class="token operator">=&gt;</span> <span class="token function">log</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>输出</p><div class="language- extra-class"><pre class="language-text"><code>0a
0b
0c
1a
1b
1c
2a
2b
2c
......
</code></pre></div><h4 id="switchmap"><a href="#switchmap" aria-hidden="true" class="header-anchor">#</a> switchMap</h4><p>当接收到新的流发出的信息, 会取消订阅前一个流, 在进行多次点击的情况并不会执行多次log而是输出最新的流返回的数据</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>Rx<span class="token punctuation">.</span><span class="token function">fromEvent</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
  <span class="token function">switchMap</span><span class="token punctuation">(</span>e <span class="token operator">=&gt;</span> Rx<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>fetchData<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="takeutil"><a href="#takeutil" aria-hidden="true" class="header-anchor">#</a> takeUtil</h4><p>用 takeUntil 接收一个通知流, 来控制另外一个流的结束,</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>Rx<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
  <span class="token function">takeUntil</span><span class="token punctuation">(</span>Rx<span class="token punctuation">.</span><span class="token function">timer</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>r <span class="token operator">=&gt;</span> <span class="token function">log</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>输出</p><div class="language- extra-class"><pre class="language-text"><code>1
2
3
// 10毫秒后结束流不再输出
</code></pre></div><h4 id="takewhile"><a href="#takewhile" aria-hidden="true" class="header-anchor">#</a> takeWhile</h4><p>类似js中的<code>while</code>语句, 当满足takeWhile的条件才会执行, 否则跳出循环结束流</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>Rx<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'iris'</span><span class="token punctuation">,</span> <span class="token string">'diana'</span><span class="token punctuation">,</span> <span class="token string">'appolo'</span><span class="token punctuation">,</span> <span class="token string">'luna'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
  op<span class="token punctuation">.</span><span class="token function">takeWhile</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> v <span class="token operator">!==</span> <span class="token string">'appolo'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>r <span class="token operator">=&gt;</span> <span class="token function">log</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>输出</p><div class="language- extra-class"><pre class="language-text"><code>iris
diana
// 结束
</code></pre></div><h4 id="buffer"><a href="#buffer" aria-hidden="true" class="header-anchor">#</a> buffer</h4><p>将一个流的数据缓存到 buffer 中, 等待另一个流通知结束, 再将buffer的数据以数组的形式 emit 出来</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>Rx<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
  <span class="token function">buffer</span><span class="token punctuation">(</span>Rx<span class="token punctuation">.</span><span class="token function">timer</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>r <span class="token operator">=&gt;</span> <span class="token function">log</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 10s 后输出一大堆数据</span>
</code></pre></div><h4 id="debouncetime"><a href="#debouncetime" aria-hidden="true" class="header-anchor">#</a> debounceTime</h4><p>防抖, 常用于持续触发的事件, 滚动等, 以下例子, 在没有数据输出, 等待1s后才会输出最后一条数据</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>Rx<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
  <span class="token function">takeUntil</span><span class="token punctuation">(</span>Rx<span class="token punctuation">.</span><span class="token function">timer</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 一秒后结束流</span>
  <span class="token function">debounceTime</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 输出最后一个值</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>r <span class="token operator">=&gt;</span> <span class="token function">log</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="throttletime"><a href="#throttletime" aria-hidden="true" class="header-anchor">#</a> throttleTime</h4><p>节流, 以下例子, 每隔 1s 取一个数据, 所以输出的数字并不会连续</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>Rx<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
  <span class="token function">throttleTime</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>r <span class="token operator">=&gt;</span> <span class="token function">log</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="scan"><a href="#scan" aria-hidden="true" class="header-anchor">#</a> scan</h4><p>类似 js中的<code>reduce</code>, 将累计值 和当前流传递发出的值进行 <code>相加</code>, 然后保存到累计值</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>Rx<span class="token punctuation">.</span><span class="token keyword">of</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'xx'</span><span class="token punctuation">,</span> state<span class="token punctuation">:</span> <span class="token string">'inited'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
   <span class="token function">scan</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> cur<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span>acc<span class="token punctuation">,</span> <span class="token operator">...</span>cur<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>state<span class="token punctuation">:</span> <span class="token string">'@@initState'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>r <span class="token operator">=&gt;</span> <span class="token function">log</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="学习资料"><a href="#学习资料" aria-hidden="true" class="header-anchor">#</a> 学习资料</h3><p><a href="https://jiayisheji.gitbooks.io/30-days-proficient-in-rxjs/content/chapter1.html" target="_blank" rel="noopener noreferrer">30 day<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p><a href="https://angularfirebase.com/lessons/rxjs-quickstart-with-20-examples/" target="_blank" rel="noopener noreferrer">20 example<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div><div class="page-edit"><!----><div class="last-updated"><span class="prefix">Last Updated: </span><span class="time">5/30/2018, 9:38:22 AM</span></div></div><!----></div></div></div>
    <script src="/assets/js/10.38700973.js" defer></script><script src="/assets/js/app.aaf8f33b.js" defer></script>
  </body>
</html>
